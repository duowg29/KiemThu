# 3.7.3. CÃ¡c BÆ°á»›c TÃ­ch Há»£p Katalon Runtime Engine (KRE) vÃ o CI/CD vá»›i GitHub Actions

## 3.7.3.1. Tá»•ng Quan

Katalon Runtime Engine (KRE) lÃ  phiÃªn báº£n headless (khÃ´ng giao diá»‡n Ä‘á»“ há»a) cá»§a Katalon Studio, Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ cháº¡y test tá»± Ä‘á»™ng trong mÃ´i trÆ°á»ng CI/CD. TÃ­ch há»£p KRE vá»›i GitHub Actions cho phÃ©p tá»± Ä‘á»™ng hÃ³a viá»‡c cháº¡y test cases má»—i khi cÃ³ thay Ä‘á»•i code hoáº·c theo lá»‹ch Ä‘á»‹nh ká»³.

**Lá»£i Ã­ch:**
- Tá»± Ä‘á»™ng hÃ³a viá»‡c cháº¡y test khi cÃ³ code má»›i
- PhÃ¡t hiá»‡n lá»—i sá»›m trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn
- Táº¡o bÃ¡o cÃ¡o test tá»± Ä‘á»™ng
- Tiáº¿t kiá»‡m thá»i gian vÃ  cÃ´ng sá»©c

**ğŸ“¸ áº¢nh cáº§n chá»¥p:**
- SÆ¡ Ä‘á»“ minh há»a quy trÃ¬nh CI/CD vá»›i KRE (tÃ¹y chá»n, cÃ³ thá»ƒ váº½ báº±ng sÆ¡ Ä‘á»“)
  
---
  
## 3.7.3.2. YÃªu Cáº§u Há»‡ Thá»‘ng

### CÃ¡c thÃ nh pháº§n cáº§n thiáº¿t:

1. **Katalon Runtime Engine (KRE)**
   - PhiÃªn báº£n: 10.4.2 trá»Ÿ lÃªn
   - ÄÃ£ Ä‘Æ°á»£c cÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh trÃªn mÃ¡y cháº¡y CI/CD
   - ÄÆ°á»ng dáº«n: `E:\App\Katalon_Studio_Engine_Windows_64-10.4.2`

2. **GitHub Repository**
   - Repository chá»©a project Katalon Studio
   - ÄÃ£ kÃ­ch hoáº¡t GitHub Actions

3. **Katalon API Key**
   - Láº¥y tá»« Katalon TestOps hoáº·c Katalon Platform
   - DÃ¹ng Ä‘á»ƒ kÃ­ch hoáº¡t license cho KRE

4. **Project Katalon Studio**
   - CÃ³ file `.prj` (project file)
   - CÃ³ cÃ¡c test suites Ä‘Ã£ Ä‘Æ°á»£c táº¡o sáºµn

**ğŸ“¸ áº¢nh cáº§n chá»¥p:**
- Cáº¥u trÃºc thÆ° má»¥c KRE sau khi cÃ i Ä‘áº·t
- File `katalonc.exe` trong thÆ° má»¥c KRE
- Cáº¥u trÃºc project Katalon Studio (cÃ³ file `.prj` vÃ  thÆ° má»¥c `Test Suites`)

---

## 3.7.3.3. CÃ¡c BÆ°á»›c Thá»±c Hiá»‡n

### BÆ°á»›c 1: CÃ i Äáº·t vÃ  Cáº¥u HÃ¬nh KRE

**Thá»±c hiá»‡n:**
1. Táº£i Katalon Runtime Engine tá»« trang chá»§ Katalon
2. Giáº£i nÃ©n vÃ o thÆ° má»¥c cá»‘ Ä‘á»‹nh (vÃ­ dá»¥: `E:\App\Katalon_Studio_Engine_Windows_64-10.4.2`)
3. Kiá»ƒm tra file `katalonc.exe` cÃ³ tá»“n táº¡i trong thÆ° má»¥c KRE

**LÆ°u Ã½:** KRE khÃ¡c vá»›i Katalon Studio GUI - KRE khÃ´ng cÃ³ giao diá»‡n Ä‘á»“ há»a, chá»‰ cháº¡y tá»« command line.

**ğŸ“¸ áº¢nh cáº§n chá»¥p:**
- MÃ n hÃ¬nh download KRE tá»« website Katalon
- Cáº¥u trÃºc thÆ° má»¥c KRE sau khi giáº£i nÃ©n
- File `katalonc.exe` trong thÆ° má»¥c KRE

---

### BÆ°á»›c 2: Láº¥y Katalon API Key

**Thá»±c hiá»‡n:**
1. ÄÄƒng nháº­p vÃ o Katalon TestOps hoáº·c Katalon Platform
2. VÃ o pháº§n Settings/API Keys
3. Táº¡o hoáº·c copy API Key
4. LÆ°u láº¡i Ä‘á»ƒ sá»­ dá»¥ng trong bÆ°á»›c tiáº¿p theo

**ğŸ“¸ áº¢nh cáº§n chá»¥p:**
- Trang Katalon TestOps/Platform hiá»ƒn thá»‹ API Key (che giáº¥u giÃ¡ trá»‹ thá»±c)

---

### BÆ°á»›c 3: Cáº¥u HÃ¬nh GitHub Secrets

**Thá»±c hiá»‡n:**
1. VÃ o repository GitHub â†’ **Settings** â†’ **Secrets and variables** â†’ **Actions**
2. Click **New repository secret**
3. TÃªn secret: `KATALON_API_KEY`
4. GiÃ¡ trá»‹: DÃ¡n API Key Ä‘Ã£ láº¥y á»Ÿ bÆ°á»›c 2
5. Click **Add secret**

**Má»¥c Ä‘Ã­ch:** LÆ°u trá»¯ API Key an toÃ n Ä‘á»ƒ workflow cÃ³ thá»ƒ sá»­ dá»¥ng mÃ  khÃ´ng lá»™ thÃ´ng tin nháº¡y cáº£m.

**ğŸ“¸ áº¢nh cáº§n chá»¥p:**
- MÃ n hÃ¬nh GitHub Secrets (Settings â†’ Secrets and variables â†’ Actions)
- MÃ n hÃ¬nh táº¡o secret má»›i vá»›i tÃªn `KATALON_API_KEY` (che giáº¥u giÃ¡ trá»‹)

---

### BÆ°á»›c 4: Táº¡o GitHub Actions Workflow

**Thá»±c hiá»‡n:**
1. Trong repository, táº¡o thÆ° má»¥c `.github/workflows/` (náº¿u chÆ°a cÃ³)
2. Táº¡o file má»›i: `katalon-tests.yml`
3. Cáº¥u hÃ¬nh workflow vá»›i cÃ¡c trigger events:
   - `push`: Cháº¡y khi cÃ³ code push lÃªn branch chÃ­nh
   - `pull_request`: Cháº¡y khi cÃ³ pull request
   - `workflow_dispatch`: Cho phÃ©p cháº¡y thá»§ cÃ´ng
   - `schedule`: Cháº¡y theo lá»‹ch (tÃ¹y chá»n)

**VÃ­ dá»¥ cáº¥u hÃ¬nh trigger:**
```yaml
on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:
  schedule:
    - cron: '0 2 * * *'  # Cháº¡y hÃ ng ngÃ y lÃºc 2h sÃ¡ng
```

**ğŸ“¸ áº¢nh cáº§n chá»¥p:**
- Cáº¥u trÃºc thÆ° má»¥c `.github/workflows/` trong repository
- File `katalon-tests.yml` má»›i táº¡o
- Ná»™i dung file workflow (má»™t pháº§n, hiá»ƒn thá»‹ pháº§n trigger)

---

### BÆ°á»›c 5: Cáº¥u HÃ¬nh Job vÃ  Environment Variables

**Thá»±c hiá»‡n:**
1. Cáº¥u hÃ¬nh job vá»›i `runs-on: self-hosted` (hoáº·c `windows-latest` náº¿u dÃ¹ng GitHub-hosted runner)
2. ThÃªm step checkout code tá»« repository
3. Cáº¥u hÃ¬nh environment variables:
   - `JAVA_OPTS`: Cáº¥u hÃ¬nh Java cháº¡y headless
   - `KATALON_OPTS`: TÃ¹y chá»n cho Katalon
   - `KATALON_API_KEY`: Láº¥y tá»« GitHub Secrets

**VÃ­ dá»¥ cáº¥u hÃ¬nh:**
```yaml
jobs:
  run-katalon-tests:
    runs-on: self-hosted
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    - name: Run Katalon Tests
      env:
        JAVA_OPTS: '-Djava.awt.headless=true'
        KATALON_API_KEY: ${{ secrets.KATALON_API_KEY }}
```

**ğŸ“¸ áº¢nh cáº§n chá»¥p:**
- Pháº§n cáº¥u hÃ¬nh job trong file workflow
- Pháº§n environment variables trong workflow file

---

### BÆ°á»›c 6: Viáº¿t Script Cháº¡y KRE

**Thá»±c hiá»‡n:**
1. Kiá»ƒm tra KRE cÃ³ tá»“n táº¡i táº¡i Ä‘Æ°á»ng dáº«n Ä‘Ã£ cáº¥u hÃ¬nh
2. TÃ¬m file executable `katalonc.exe`
3. Kiá»ƒm tra license (API Key hoáº·c offline license)
4. XÃ¡c Ä‘á»‹nh project path vÃ  test suite path
5. XÃ¢y dá»±ng lá»‡nh cháº¡y KRE vá»›i cÃ¡c tham sá»‘:
   - `-projectPath`: ÄÆ°á»ng dáº«n Ä‘áº¿n project
   - `-testSuitePath`: ÄÆ°á»ng dáº«n Ä‘áº¿n test suite
   - `-browserType`: Chrome (headless)
   - `-reportFolder`: ThÆ° má»¥c lÆ°u bÃ¡o cÃ¡o
   - `-apiKey`: API Key Ä‘á»ƒ kÃ­ch hoáº¡t license

**VÃ­ dá»¥ lá»‡nh cháº¡y:**
```powershell
$KRE_HOME = "E:\App\Katalon_Studio_Engine_Windows_64-10.4.2"
$katalonExe = "$KRE_HOME\katalonc.exe"
$projectPath = (Resolve-Path $PWD).Path
$testSuitePath = "Test Suites/UI/Navigation Testcases"

& $katalonExe -runMode=console `
  -projectPath=$projectPath `
  -testSuitePath=$testSuitePath `
  -browserType="Chrome (headless)" `
  -reportFolder="Reports" `
  -apiKey=$env:KATALON_API_KEY
```

**ğŸ“¸ áº¢nh cáº§n chá»¥p:**
- Log output khi KRE Ä‘Æ°á»£c tÃ¬m tháº¥y thÃ nh cÃ´ng
- Log output hiá»ƒn thá»‹ cÃ¡c tham sá»‘ Ä‘Ã£ cáº¥u hÃ¬nh
- Command line cuá»‘i cÃ¹ng Ä‘Æ°á»£c execute

---

### BÆ°á»›c 7: Xá»­ LÃ½ Káº¿t Quáº£ vÃ  Táº¡o BÃ¡o CÃ¡o

**Thá»±c hiá»‡n:**
1. Monitor quÃ¡ trÃ¬nh cháº¡y test (cÃ³ timeout Ä‘á»ƒ trÃ¡nh treo)
2. Capture output vÃ  errors tá»« KRE
3. Kiá»ƒm tra thÆ° má»¥c Reports sau khi test hoÃ n thÃ nh
4. PhÃ¢n tÃ­ch káº¿t quáº£ tá»« JUnit report (náº¿u cÃ³)
5. Format CSV report vá»›i UTF-8 BOM Ä‘á»ƒ Excel hiá»ƒn thá»‹ Ä‘Ãºng tiáº¿ng Viá»‡t
6. Upload reports lÃªn GitHub Actions artifacts

**CÃ¡c loáº¡i bÃ¡o cÃ¡o Ä‘Æ°á»£c táº¡o:**
- HTML report: BÃ¡o cÃ¡o chi tiáº¿t vá»›i giao diá»‡n web
- CSV report: BÃ¡o cÃ¡o dáº¡ng báº£ng, dá»… import vÃ o Excel
- JUnit XML report: BÃ¡o cÃ¡o chuáº©n Ä‘á»ƒ tÃ­ch há»£p vá»›i cÃ¡c tool khÃ¡c

**ğŸ“¸ áº¢nh cáº§n chá»¥p:**
- Log output trong quÃ¡ trÃ¬nh test cháº¡y (real-time)
- Cáº¥u trÃºc thÆ° má»¥c Reports sau khi test hoÃ n thÃ nh
- HTML report Ä‘Æ°á»£c má»Ÿ trong browser
- CSV report má»Ÿ trong Excel (kiá»ƒm tra encoding tiáº¿ng Viá»‡t)
- MÃ n hÃ¬nh GitHub Actions artifacts sau khi upload

---

### BÆ°á»›c 8: Kiá»ƒm Tra vÃ  XÃ¡c Thá»±c

**Thá»±c hiá»‡n:**
1. Push code lÃªn repository Ä‘á»ƒ trigger workflow
2. VÃ o tab **Actions** trÃªn GitHub Ä‘á»ƒ xem workflow Ä‘ang cháº¡y
3. Kiá»ƒm tra logs tá»«ng step Ä‘á»ƒ Ä‘áº£m báº£o khÃ´ng cÃ³ lá»—i
4. Xem test results summary trong logs
5. Download artifacts vÃ  kiá»ƒm tra reports

**CÃ¡c tráº¡ng thÃ¡i cÃ³ thá»ƒ:**
- âœ… **Success**: Táº¥t cáº£ test pass, exit code = 0
- âš ï¸ **Partial Success**: Test cháº¡y nhÆ°ng cÃ³ failures, exit code = 1
- âŒ **Failed**: Lá»—i cáº¥u hÃ¬nh hoáº·c execution, exit code = 2 hoáº·c 3

**ğŸ“¸ áº¢nh cáº§n chá»¥p:**
- MÃ n hÃ¬nh GitHub Actions vá»›i workflow Ä‘ang cháº¡y
- Log output cá»§a cÃ¡c step chÃ­nh (checkout, run tests, upload artifacts)
- Test results summary trong GitHub Actions logs
- Workflow status: success/failure
- MÃ n hÃ¬nh artifacts vá»›i cÃ¡c file report Ä‘Ã£ upload

---

## 3.7.3.4. Káº¿t Quáº£ Äáº¡t ÄÆ°á»£c

Sau khi hoÃ n thÃ nh cÃ¡c bÆ°á»›c trÃªn, há»‡ thá»‘ng CI/CD Ä‘Ã£ Ä‘Æ°á»£c tÃ­ch há»£p thÃ nh cÃ´ng vá»›i cÃ¡c káº¿t quáº£:

- âœ… Test tá»± Ä‘á»™ng cháº¡y khi cÃ³ code push hoáº·c pull request
- âœ… Test cháº¡y theo lá»‹ch Ä‘á»‹nh ká»³ (náº¿u cáº¥u hÃ¬nh schedule)
- âœ… Káº¿t quáº£ test Ä‘Æ°á»£c lÆ°u trá»¯ vÃ  phÃ¢n tÃ­ch tá»± Ä‘á»™ng
- âœ… BÃ¡o cÃ¡o Ä‘Æ°á»£c format vÃ  upload lÃªn GitHub Actions artifacts
- âœ… PhÃ¡t hiá»‡n lá»—i sá»›m trong quÃ¡ trÃ¬nh phÃ¡t triá»ƒn

**ğŸ“¸ áº¢nh cáº§n chá»¥p:**
- Tá»•ng quan mÃ n hÃ¬nh GitHub Actions vá»›i nhiá»u workflow runs
- So sÃ¡nh káº¿t quáº£ giá»¯a cÃ¡c láº§n cháº¡y (success/failure rate)
- Dashboard tá»•ng há»£p káº¿t quáº£ test (náº¿u cÃ³)

---

## 3.7.3.5. LÆ°u Ã vÃ  Khuyáº¿n Nghá»‹

### LÆ°u Ã½ quan trá»ng:

1. **KRE vs Katalon Studio GUI:**
   - KRE lÃ  phiÃªn báº£n headless, khÃ´ng cÃ³ giao diá»‡n Ä‘á»“ há»a
   - Chá»‰ cháº¡y Ä‘Æ°á»£c tá»« command line
   - PhÃ¹ há»£p cho mÃ´i trÆ°á»ng CI/CD

2. **License:**
   - KRE cáº§n license Ä‘á»ƒ cháº¡y
   - CÃ³ thá»ƒ dÃ¹ng API Key (khuyáº¿n nghá»‹) hoáº·c offline license
   - API Key nÃªn lÆ°u trong GitHub Secrets Ä‘á»ƒ báº£o máº­t

3. **Self-hosted Runner:**
   - Náº¿u dÃ¹ng `runs-on: self-hosted`, cáº§n cÃ i Ä‘áº·t GitHub Actions Runner trÃªn mÃ¡y
   - Äáº£m báº£o mÃ¡y runner luÃ´n online vÃ  cÃ³ KRE Ä‘Ã£ cÃ i Ä‘áº·t

4. **Timeout:**
   - NÃªn cáº¥u hÃ¬nh timeout cho workflow Ä‘á»ƒ trÃ¡nh treo
   - Thá»i gian timeout phá»¥ thuá»™c vÃ o sá»‘ lÆ°á»£ng test cases

### Khuyáº¿n nghá»‹:

- NÃªn cháº¡y test trÃªn nhiá»u browser khÃ¡c nhau (Chrome, Firefox, Edge)
- CÃ³ thá»ƒ chia test suite thÃ nh nhiá»u pháº§n vÃ  cháº¡y song song Ä‘á»ƒ tÄƒng tá»‘c
- NÃªn cáº¥u hÃ¬nh notification khi test fail Ä‘á»ƒ team biáº¿t ngay

---

## TÃ³m Táº¯t Danh SÃ¡ch áº¢nh Cáº§n Chá»¥p

### A. Chuáº©n Bá»‹ (BÆ°á»›c 1-2)
1. MÃ n hÃ¬nh download KRE tá»« website Katalon
2. Cáº¥u trÃºc thÆ° má»¥c KRE sau khi giáº£i nÃ©n
3. File `katalonc.exe` trong thÆ° má»¥c KRE
4. Cáº¥u trÃºc project Katalon Studio (file `.prj` vÃ  thÆ° má»¥c `Test Suites`)
5. Trang Katalon TestOps/Platform hiá»ƒn thá»‹ API Key

### B. Cáº¥u HÃ¬nh GitHub (BÆ°á»›c 3-4)
6. MÃ n hÃ¬nh GitHub Secrets (Settings â†’ Secrets and variables â†’ Actions)
7. MÃ n hÃ¬nh táº¡o secret `KATALON_API_KEY`
8. Cáº¥u trÃºc thÆ° má»¥c `.github/workflows/` trong repository
9. File `katalon-tests.yml` má»›i táº¡o
10. Ná»™i dung file workflow (pháº§n trigger vÃ  cáº¥u hÃ¬nh job)

### C. Cháº¡y Test (BÆ°á»›c 5-6)
11. Pháº§n environment variables trong workflow file
12. Log output khi KRE Ä‘Æ°á»£c tÃ¬m tháº¥y thÃ nh cÃ´ng
13. Log output hiá»ƒn thá»‹ cÃ¡c tham sá»‘ Ä‘Ã£ cáº¥u hÃ¬nh
14. Command line cuá»‘i cÃ¹ng Ä‘Æ°á»£c execute

### D. Káº¿t Quáº£ (BÆ°á»›c 7-8)
15. Log output trong quÃ¡ trÃ¬nh test cháº¡y (real-time)
16. Cáº¥u trÃºc thÆ° má»¥c Reports sau khi test hoÃ n thÃ nh
17. HTML report Ä‘Æ°á»£c má»Ÿ trong browser
18. CSV report má»Ÿ trong Excel (kiá»ƒm tra encoding)
19. MÃ n hÃ¬nh GitHub Actions vá»›i workflow Ä‘ang cháº¡y
20. Log output cá»§a cÃ¡c step chÃ­nh
21. Test results summary trong GitHub Actions logs
22. Workflow status: success/failure
23. MÃ n hÃ¬nh artifacts vá»›i cÃ¡c file report Ä‘Ã£ upload

### E. Tá»•ng Quan
24. Tá»•ng quan mÃ n hÃ¬nh GitHub Actions vá»›i nhiá»u workflow runs
25. So sÃ¡nh káº¿t quáº£ giá»¯a cÃ¡c láº§n cháº¡y

---

**LÆ°u Ã½:** Táº¥t cáº£ áº£nh nÃªn cÃ³ chÃº thÃ­ch rÃµ rÃ ng vÃ  Ä‘Æ°á»£c Ä‘Ã¡nh sá»‘ theo thá»© tá»± trong bÃ¡o cÃ¡o. áº¢nh nÃªn cÃ³ Ä‘á»™ phÃ¢n giáº£i Ä‘á»§ Ä‘á»ƒ Ä‘á»c Ä‘Æ°á»£c text trong log output.

